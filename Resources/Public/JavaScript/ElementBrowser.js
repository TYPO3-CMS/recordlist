/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
define(["require","exports","jquery","TYPO3/CMS/Backend/Modal"],function(e,t,r,i){"use strict";return new(function(){function e(){var e=this;this.hasActionMultipleCode=!1,this.thisScriptUrl="",this.mode="",this.formFieldName="",this.fieldReference="",this.fieldReferenceSlashed="",this.rte={parameters:"",configuration:""},this.irre={objectId:0,checkUniqueAction:"",addAction:"",insertAction:""},this.focusOpenerAndClose=function(){e.getParent()&&e.getParent().focus(),i.dismiss(),close()},r(function(){var t=r("body").data();e.thisScriptUrl=t.thisScriptUrl,e.mode=t.mode,e.formFieldName=t.formFieldName,e.fieldReference=t.fieldReference,e.fieldReferenceSlashed=t.fieldReferenceSlashed,e.rte.parameters=t.rteParameters,e.rte.configuration=t.rteConfiguration,e.irre.checkUniqueAction=t.irreCheckUniqueAction,e.irre.addAction=t.irreAddAction,e.irre.insertAction=t.irreInsertAction,e.irre.objectId=t.irreObjectId,e.hasActionMultipleCode=e.irre.objectId>0&&""!==e.irre.insertAction}),window.jumpToUrl=function(t,r){"?"===t.charAt(0)&&(t=e.thisScriptUrl+t.substring(1));var i=-1===t.indexOf("mode=")?"&mode="+encodeURIComponent(e.mode):"";return window.location.href=t+i+("string"==typeof r?r:""),!1}}return e.prototype.setReferences=function(){return!!(this.getParent()&&this.getParent().content&&this.getParent().content.document.editform&&this.getParent().content.document.editform[this.formFieldName])&&(this.targetDoc=this.getParent().content.document,this.elRef=this.targetDoc.editform[this.formFieldName],!0)},e.prototype.executeFunctionByName=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];for(var n=e.split("."),o=n.pop(),s=0;s<n.length;s++)t=t[n[s]];return t[o].apply(t,r)},e.prototype.getParent=function(){var e=null;return void 0!==window.parent&&void 0!==window.parent.document.list_frame&&null!==window.parent.document.list_frame.parent.document.querySelector(".t3js-modal-iframe")?e=window.parent.document.list_frame:void 0!==window.parent&&void 0!==window.parent.frames.list_frame&&null!==window.parent.frames.list_frame.parent.document.querySelector(".t3js-modal-iframe")?e=window.parent.frames.list_frame:void 0!==window.frames&&void 0!==window.frames.frameElement&&null!==window.frames.frameElement&&window.frames.frameElement.classList.contains("t3js-modal-iframe")?e=window.frames.frameElement.contentWindow.parent:window.opener&&(e=window.opener),e},e.prototype.insertElement=function(e,t,r,i,n,o,s,a,c){var d=!0;if(this.irre.objectId&&this.irre.checkUniqueAction)if(this.getParent()){var f=this.executeFunctionByName(this.irre.checkUniqueAction,this.getParent(),this.irre.objectId,e,t,r);f.passed||(f.message&&alert(f.message),d=!1)}else alert("Error - reference to main window is not set properly!"),this.focusOpenerAndClose();return d&&(this.irre.objectId&&this.irre.addAction&&(this.getParent()?this.executeFunctionByName(this.irre.addAction,this.getParent(),this.irre.objectId,e,t,r,this.fieldReferenceSlashed):(alert("Error - reference to main window is not set properly!"),this.focusOpenerAndClose())),this.irre.objectId&&this.irre.insertAction?this.getParent()?(this.executeFunctionByName(this.irre.insertAction,this.getParent(),this.irre.objectId,e,t,r),c&&this.focusOpenerAndClose()):(alert("Error - reference to main window is not set properly!"),c&&this.focusOpenerAndClose()):!this.fieldReference||this.rte.parameters||this.rte.configuration?(this.getParent()&&this.getParent().content&&this.getParent().content.document.editform&&this.getParent().content.document.editform[this.formFieldName]?this.getParent().group_change("add",this.fieldReference,this.rte.parameters,this.rte.configuration,this.targetDoc.editform[this.formFieldName],this.getParent().content.document):alert("Error - reference to main window is not set properly!"),c&&this.focusOpenerAndClose()):this.addElement(i,e+"_"+t,n,c)),!1},e.prototype.insertMultiple=function(e,t){return this.irre.objectId&&this.irre.insertAction&&(this.getParent()?this.executeFunctionByName(this.irre.insertAction+"Multiple",this.getParent(),this.irre.objectId,e,t,"",this.fieldReference):(alert("Error - reference to main window is not set properly!"),this.focusOpenerAndClose())),!1},e.prototype.addElement=function(e,t,r,i){this.getParent()&&this.getParent().setFormValueFromBrowseWin?(this.getParent().setFormValueFromBrowseWin(this.fieldReference,r||t,e),i&&this.focusOpenerAndClose()):(alert("Error - reference to main window is not set properly!"),this.focusOpenerAndClose())},e}())});